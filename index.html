<!DOCTYPE html>
<html>
  <head>
    <title>sisensyo!!!</title>
  </head>
  <body>
    <div>
      <img id="f0_0" src="" width="47" height="63" onclick="imgClick(0, 0)"/>
      <img id="f0_1" src="" width="47" height="63" onclick="imgClick(0, 1)"/>
      <img id="f0_2" src="" width="47" height="63" onclick="imgClick(0, 2)"/>
      <img id="f0_3" src="" width="47" height="63" onclick="imgClick(0, 3)"/>
      <img id="f0_4" src="" width="47" height="63" onclick="imgClick(0, 4)"/>
      <img id="f0_5" src="" width="47" height="63" onclick="imgClick(0, 5)"/>
      <img id="f0_6" src="" width="47" height="63" onclick="imgClick(0, 6)"/>
      <img id="f0_7" src="" width="47" height="63" onclick="imgClick(0, 7)"/>
      <img id="f0_8" src="" width="47" height="63" onclick="imgClick(0, 8)"/>
      <img id="f0_9" src="" width="47" height="63" onclick="imgClick(0, 9)"/>
      <img id="f0_10" src="" width="47" height="63" onclick="imgClick(0, 10)"/>
      <img id="f0_11" src="" width="47" height="63" onclick="imgClick(0, 11)"/>
      <img id="f0_12" src="" width="47" height="63" onclick="imgClick(0, 12)"/>
      <img id="f0_13" src="" width="47" height="63" onclick="imgClick(0, 13)"/>
      <img id="f0_14" src="" width="47" height="63" onclick="imgClick(0, 14)"/>
      <img id="f0_15" src="" width="47" height="63" onclick="imgClick(0, 15)"/>
      <img id="f0_16" src="" width="47" height="63" onclick="imgClick(0, 16)"/>
      <img id="f0_17" src="" width="47" height="63" onclick="imgClick(0, 17)"/>
      <img id="f0_18" src="" width="47" height="63" onclick="imgClick(0, 18)"/>
    </div>
    <div>
      <img id="f1_0"  src="" width="47" height="63" onclick="imgClick(1, 0)"/>
      <img id="f1_1"  src="" width="47" height="63" onclick="imgClick(1, 1)"/>
      <img id="f1_2"  src="" width="47" height="63" onclick="imgClick(1, 2)"/>
      <img id="f1_3"  src="" width="47" height="63" onclick="imgClick(1, 3)"/>
      <img id="f1_4"  src="" width="47" height="63" onclick="imgClick(1, 4)"/>
      <img id="f1_5"  src="" width="47" height="63" onclick="imgClick(1, 5)"/>
      <img id="f1_6"  src="" width="47" height="63" onclick="imgClick(1, 6)"/>
      <img id="f1_7"  src="" width="47" height="63" onclick="imgClick(1, 7)"/>
      <img id="f1_8"  src="" width="47" height="63" onclick="imgClick(1, 8)"/>
      <img id="f1_9"  src="" width="47" height="63" onclick="imgClick(1, 9)"/>
      <img id="f1_10" src="" width="47" height="63" onclick="imgClick(1, 10)"/>
      <img id="f1_11" src="" width="47" height="63" onclick="imgClick(1, 11)"/>
      <img id="f1_12" src="" width="47" height="63" onclick="imgClick(1, 12)"/>
      <img id="f1_13" src="" width="47" height="63" onclick="imgClick(1, 13)"/>
      <img id="f1_14" src="" width="47" height="63" onclick="imgClick(1, 14)"/>
      <img id="f1_15" src="" width="47" height="63" onclick="imgClick(1, 15)"/>
      <img id="f1_16" src="" width="47" height="63" onclick="imgClick(1, 16)"/>
      <img id="f1_17" src="" width="47" height="63" onclick="imgClick(1, 17)"/>
      <img id="f1_18" src="" width="47" height="63" onclick="imgClick(1, 18)"/>
    </div>
    <div>
      <img id="f2_0"  src="" width="47" height="63" onclick="imgClick(2, 0)"/>
      <img id="f2_1"  src="" width="47" height="63" onclick="imgClick(2, 1)"/>
      <img id="f2_2"  src="" width="47" height="63" onclick="imgClick(2, 2)"/>
      <img id="f2_3"  src="" width="47" height="63" onclick="imgClick(2, 3)"/>
      <img id="f2_4"  src="" width="47" height="63" onclick="imgClick(2, 4)"/>
      <img id="f2_5"  src="" width="47" height="63" onclick="imgClick(2, 5)"/>
      <img id="f2_6"  src="" width="47" height="63" onclick="imgClick(2, 6)"/>
      <img id="f2_7"  src="" width="47" height="63" onclick="imgClick(2, 7)"/>
      <img id="f2_8"  src="" width="47" height="63" onclick="imgClick(2, 8)"/>
      <img id="f2_9"  src="" width="47" height="63" onclick="imgClick(2, 9)"/>
      <img id="f2_10" src="" width="47" height="63" onclick="imgClick(2, 10)"/>
      <img id="f2_11" src="" width="47" height="63" onclick="imgClick(2, 11)"/>
      <img id="f2_12" src="" width="47" height="63" onclick="imgClick(2, 12)"/>
      <img id="f2_13" src="" width="47" height="63" onclick="imgClick(2, 13)"/>
      <img id="f2_14" src="" width="47" height="63" onclick="imgClick(2, 14)"/>
      <img id="f2_15" src="" width="47" height="63" onclick="imgClick(2, 15)"/>
      <img id="f2_16" src="" width="47" height="63" onclick="imgClick(2, 16)"/>
      <img id="f2_17" src="" width="47" height="63" onclick="imgClick(2, 17)"/>
      <img id="f2_18" src="" width="47" height="63" onclick="imgClick(2, 18)"/>
    </div>
    <div>
      <img id="f3_0"  src="" width="47" height="63" onclick="imgClick(3, 0)"/>
      <img id="f3_1"  src="" width="47" height="63" onclick="imgClick(3, 1)"/>
      <img id="f3_2"  src="" width="47" height="63" onclick="imgClick(3, 2)"/>
      <img id="f3_3"  src="" width="47" height="63" onclick="imgClick(3, 3)"/>
      <img id="f3_4"  src="" width="47" height="63" onclick="imgClick(3, 4)"/>
      <img id="f3_5"  src="" width="47" height="63" onclick="imgClick(3, 5)"/>
      <img id="f3_6"  src="" width="47" height="63" onclick="imgClick(3, 6)"/>
      <img id="f3_7"  src="" width="47" height="63" onclick="imgClick(3, 7)"/>
      <img id="f3_8"  src="" width="47" height="63" onclick="imgClick(3, 8)"/>
      <img id="f3_9"  src="" width="47" height="63" onclick="imgClick(3, 9)"/>
      <img id="f3_10" src="" width="47" height="63" onclick="imgClick(3, 10)"/>
      <img id="f3_11" src="" width="47" height="63" onclick="imgClick(3, 11)"/>
      <img id="f3_12" src="" width="47" height="63" onclick="imgClick(3, 12)"/>
      <img id="f3_13" src="" width="47" height="63" onclick="imgClick(3, 13)"/>
      <img id="f3_14" src="" width="47" height="63" onclick="imgClick(3, 14)"/>
      <img id="f3_15" src="" width="47" height="63" onclick="imgClick(3, 15)"/>
      <img id="f3_16" src="" width="47" height="63" onclick="imgClick(3, 16)"/>
      <img id="f3_17" src="" width="47" height="63" onclick="imgClick(3, 17)"/>
      <img id="f3_18" src="" width="47" height="63" onclick="imgClick(3, 18)"/>
    </div>
    <div>
      <img id="f4_0"  src="" width="47" height="63" onclick="imgClick(4, 0)"/>
      <img id="f4_1"  src="" width="47" height="63" onclick="imgClick(4, 1)"/>
      <img id="f4_2"  src="" width="47" height="63" onclick="imgClick(4, 2)"/>
      <img id="f4_3"  src="" width="47" height="63" onclick="imgClick(4, 3)"/>
      <img id="f4_4"  src="" width="47" height="63" onclick="imgClick(4, 4)"/>
      <img id="f4_5"  src="" width="47" height="63" onclick="imgClick(4, 5)"/>
      <img id="f4_6"  src="" width="47" height="63" onclick="imgClick(4, 6)"/>
      <img id="f4_7"  src="" width="47" height="63" onclick="imgClick(4, 7)"/>
      <img id="f4_8"  src="" width="47" height="63" onclick="imgClick(4, 8)"/>
      <img id="f4_9"  src="" width="47" height="63" onclick="imgClick(4, 9)"/>
      <img id="f4_10" src="" width="47" height="63" onclick="imgClick(4, 10)"/>
      <img id="f4_11" src="" width="47" height="63" onclick="imgClick(4, 11)"/>
      <img id="f4_12" src="" width="47" height="63" onclick="imgClick(4, 12)"/>
      <img id="f4_13" src="" width="47" height="63" onclick="imgClick(4, 13)"/>
      <img id="f4_14" src="" width="47" height="63" onclick="imgClick(4, 14)"/>
      <img id="f4_15" src="" width="47" height="63" onclick="imgClick(4, 15)"/>
      <img id="f4_16" src="" width="47" height="63" onclick="imgClick(4, 16)"/>
      <img id="f4_17" src="" width="47" height="63" onclick="imgClick(4, 17)"/>
      <img id="f4_18" src="" width="47" height="63" onclick="imgClick(4, 18)"/>
    </div>
    <div>
      <img id="f5_0"  src="" width="47" height="63" onclick="imgClick(5, 0)"/>
      <img id="f5_1"  src="" width="47" height="63" onclick="imgClick(5, 1)"/>
      <img id="f5_2"  src="" width="47" height="63" onclick="imgClick(5, 2)"/>
      <img id="f5_3"  src="" width="47" height="63" onclick="imgClick(5, 3)"/>
      <img id="f5_4"  src="" width="47" height="63" onclick="imgClick(5, 4)"/>
      <img id="f5_5"  src="" width="47" height="63" onclick="imgClick(5, 5)"/>
      <img id="f5_6"  src="" width="47" height="63" onclick="imgClick(5, 6)"/>
      <img id="f5_7"  src="" width="47" height="63" onclick="imgClick(5, 7)"/>
      <img id="f5_8"  src="" width="47" height="63" onclick="imgClick(5, 8)"/>
      <img id="f5_9"  src="" width="47" height="63" onclick="imgClick(5, 9)"/>
      <img id="f5_10" src="" width="47" height="63" onclick="imgClick(5, 10)"/>
      <img id="f5_11" src="" width="47" height="63" onclick="imgClick(5, 11)"/>
      <img id="f5_12" src="" width="47" height="63" onclick="imgClick(5, 12)"/>
      <img id="f5_13" src="" width="47" height="63" onclick="imgClick(5, 13)"/>
      <img id="f5_14" src="" width="47" height="63" onclick="imgClick(5, 14)"/>
      <img id="f5_15" src="" width="47" height="63" onclick="imgClick(5, 15)"/>
      <img id="f5_16" src="" width="47" height="63" onclick="imgClick(5, 16)"/>
      <img id="f5_17" src="" width="47" height="63" onclick="imgClick(5, 17)"/>
      <img id="f5_18" src="" width="47" height="63" onclick="imgClick(5, 18)"/>
    </div>
    <div>
      <img id="f6_0"  src="" width="47" height="63" onclick="imgClick(6, 0)"/>
      <img id="f6_1"  src="" width="47" height="63" onclick="imgClick(6, 1)"/>
      <img id="f6_2"  src="" width="47" height="63" onclick="imgClick(6, 2)"/>
      <img id="f6_3"  src="" width="47" height="63" onclick="imgClick(6, 3)"/>
      <img id="f6_4"  src="" width="47" height="63" onclick="imgClick(6, 4)"/>
      <img id="f6_5"  src="" width="47" height="63" onclick="imgClick(6, 5)"/>
      <img id="f6_6"  src="" width="47" height="63" onclick="imgClick(6, 6)"/>
      <img id="f6_7"  src="" width="47" height="63" onclick="imgClick(6, 7)"/>
      <img id="f6_8"  src="" width="47" height="63" onclick="imgClick(6, 8)"/>
      <img id="f6_9"  src="" width="47" height="63" onclick="imgClick(6, 9)"/>
      <img id="f6_10" src="" width="47" height="63" onclick="imgClick(6, 10)"/>
      <img id="f6_11" src="" width="47" height="63" onclick="imgClick(6, 11)"/>
      <img id="f6_12" src="" width="47" height="63" onclick="imgClick(6, 12)"/>
      <img id="f6_13" src="" width="47" height="63" onclick="imgClick(6, 13)"/>
      <img id="f6_14" src="" width="47" height="63" onclick="imgClick(6, 14)"/>
      <img id="f6_15" src="" width="47" height="63" onclick="imgClick(6, 15)"/>
      <img id="f6_16" src="" width="47" height="63" onclick="imgClick(6, 16)"/>
      <img id="f6_17" src="" width="47" height="63" onclick="imgClick(6, 17)"/>
      <img id="f6_18" src="" width="47" height="63" onclick="imgClick(6, 18)"/>
    </div>
    <div>
      <img id="f7_0"  src="" width="47" height="63" onclick="imgClick(7, 0)"/>
      <img id="f7_1"  src="" width="47" height="63" onclick="imgClick(7, 1)"/>
      <img id="f7_2"  src="" width="47" height="63" onclick="imgClick(7, 2)"/>
      <img id="f7_3"  src="" width="47" height="63" onclick="imgClick(7, 3)"/>
      <img id="f7_4"  src="" width="47" height="63" onclick="imgClick(7, 4)"/>
      <img id="f7_5"  src="" width="47" height="63" onclick="imgClick(7, 5)"/>
      <img id="f7_6"  src="" width="47" height="63" onclick="imgClick(7, 6)"/>
      <img id="f7_7"  src="" width="47" height="63" onclick="imgClick(7, 7)"/>
      <img id="f7_8"  src="" width="47" height="63" onclick="imgClick(7, 8)"/>
      <img id="f7_9"  src="" width="47" height="63" onclick="imgClick(7, 9)"/>
      <img id="f7_10" src="" width="47" height="63" onclick="imgClick(7, 10)"/>
      <img id="f7_11" src="" width="47" height="63" onclick="imgClick(7, 11)"/>
      <img id="f7_12" src="" width="47" height="63" onclick="imgClick(7, 12)"/>
      <img id="f7_13" src="" width="47" height="63" onclick="imgClick(7, 13)"/>
      <img id="f7_14" src="" width="47" height="63" onclick="imgClick(7, 14)"/>
      <img id="f7_15" src="" width="47" height="63" onclick="imgClick(7, 15)"/>
      <img id="f7_16" src="" width="47" height="63" onclick="imgClick(7, 16)"/>
      <img id="f7_17" src="" width="47" height="63" onclick="imgClick(7, 17)"/>
      <img id="f7_18" src="" width="47" height="63" onclick="imgClick(7, 18)"/>
    </div>
    <div>
      <img id="f8_0"  src="" width="47" height="63" onclick="imgClick(8, 0)"/>
      <img id="f8_1"  src="" width="47" height="63" onclick="imgClick(8, 1)"/>
      <img id="f8_2"  src="" width="47" height="63" onclick="imgClick(8, 2)"/>
      <img id="f8_3"  src="" width="47" height="63" onclick="imgClick(8, 3)"/>
      <img id="f8_4"  src="" width="47" height="63" onclick="imgClick(8, 4)"/>
      <img id="f8_5"  src="" width="47" height="63" onclick="imgClick(8, 5)"/>
      <img id="f8_6"  src="" width="47" height="63" onclick="imgClick(8, 6)"/>
      <img id="f8_7"  src="" width="47" height="63" onclick="imgClick(8, 7)"/>
      <img id="f8_8"  src="" width="47" height="63" onclick="imgClick(8, 8)"/>
      <img id="f8_9"  src="" width="47" height="63" onclick="imgClick(8, 9)"/>
      <img id="f8_10" src="" width="47" height="63" onclick="imgClick(8, 10)"/>
      <img id="f8_11" src="" width="47" height="63" onclick="imgClick(8, 11)"/>
      <img id="f8_12" src="" width="47" height="63" onclick="imgClick(8, 12)"/>
      <img id="f8_13" src="" width="47" height="63" onclick="imgClick(8, 13)"/>
      <img id="f8_14" src="" width="47" height="63" onclick="imgClick(8, 14)"/>
      <img id="f8_15" src="" width="47" height="63" onclick="imgClick(8, 15)"/>
      <img id="f8_16" src="" width="47" height="63" onclick="imgClick(8, 16)"/>
      <img id="f8_17" src="" width="47" height="63" onclick="imgClick(8, 17)"/>
      <img id="f8_18" src="" width="47" height="63" onclick="imgClick(8, 18)"/>
    </div>
    <div>
      <img id="f9_0"  src="" width="47" height="63" onclick="imgClick(9, 0)"/>
      <img id="f9_1"  src="" width="47" height="63" onclick="imgClick(9, 1)"/>
      <img id="f9_2"  src="" width="47" height="63" onclick="imgClick(9, 2)"/>
      <img id="f9_3"  src="" width="47" height="63" onclick="imgClick(9, 3)"/>
      <img id="f9_4"  src="" width="47" height="63" onclick="imgClick(9, 4)"/>
      <img id="f9_5"  src="" width="47" height="63" onclick="imgClick(9, 5)"/>
      <img id="f9_6"  src="" width="47" height="63" onclick="imgClick(9, 6)"/>
      <img id="f9_7"  src="" width="47" height="63" onclick="imgClick(9, 7)"/>
      <img id="f9_8"  src="" width="47" height="63" onclick="imgClick(9, 8)"/>
      <img id="f9_9"  src="" width="47" height="63" onclick="imgClick(9, 9)"/>
      <img id="f9_10" src="" width="47" height="63" onclick="imgClick(9, 10)"/>
      <img id="f9_11" src="" width="47" height="63" onclick="imgClick(9, 11)"/>
      <img id="f9_12" src="" width="47" height="63" onclick="imgClick(9, 12)"/>
      <img id="f9_13" src="" width="47" height="63" onclick="imgClick(9, 13)"/>
      <img id="f9_14" src="" width="47" height="63" onclick="imgClick(9, 14)"/>
      <img id="f9_15" src="" width="47" height="63" onclick="imgClick(9, 15)"/>
      <img id="f9_16" src="" width="47" height="63" onclick="imgClick(9, 16)"/>
      <img id="f9_17" src="" width="47" height="63" onclick="imgClick(9, 17)"/>
      <img id="f9_18" src="" width="47" height="63" onclick="imgClick(9, 18)"/>
    </div>
    <script>
      var field = [
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ]

      for (y=1; y<=8; y++) {
        for (x=1; x<=17; x++) {
          field[y][x] = Math.floor(Math.random() * 7) + 1
        }
      }

      var selectedX = -1
      var selectedY = -1

      for (y=0; y<10; y++) {
        for (x=0; x<19; x++) {
          var elem = document.getElementById("f"+y+"_"+x);
          elem.src = "https://ref3000.github.io/shisensyo/img/" + field[y][x] + ".gif";
        }
      }

      function imgClick(y, x) {
        if (selectedX < 0 || selectedY < 0) {
          selectedX = x;
          selectedY = y;
        } else {
          if (canRemove(selectedX, selectedY, x, y)) {
            var e1 = document.getElementById("f"+selectedY+"_"+selectedX);
            var e2 = document.getElementById("f"+y+"_"+x);
            e1.src = "https://ref3000.github.io/shisensyo/img/0.gif";
            e2.src = "https://ref3000.github.io/shisensyo/img/0.gif";
            field[selectedY][selectedX] = 0;
            field[y][x] = 0;
          }
          selectedX = -1
          selectedY = -1
        }
        console.log(selectedY, selectedX)
      }

      function canRemove(x1, y1, x2, y2) {
        console.log("canRemove", x1, y1, x2, y2, getTileNum(x1, y1), getTileNum(x2, y2))
        if (x1 == x2 && y1 == y2) return false;
        if (getTileNum(x1, y1) < 1 || getTileNum(x2, y2) < 1) return false;
        if (getTileNum(x1, y1) != getTileNum(x2, y2)) return false;
        var p0 = [];
        var p1 = [];
        var p2 = [];

        var dxs = [0, 1, 0, -1];
        var dys = [-1, 0, 1, 0];
        for (i=0; i<4; i++) {
          dx = dxs[i]
          dy = dys[i]
          for (j=1; j<100; j++) {
            x = x1 + dx*j
            y = y1 + dy*j
            num = getTileNum(x, y)
            if (num != 0) {
              if (x == x2 && y == y2) return true;
              break;
            }
            p0.push([x, y])
          }
        }
        for (pi=0; pi<p0.length; pi++) {
          p = p0[pi]
          px = p[0]
          py = p[1]
          for (i=0; i<4; i++) {
            dx = dxs[i]
            dy = dys[i]
            for (j=1; j<100; j++) {
              x = px + dx*j
              y = py + dy*j
              num = getTileNum(x, y)
              if (num != 0) {
                if (x == x2 && y == y2) return true;
                break;
              }
              p1.push([x, y])
            }
          }
        }
        for (pi=0; pi<p1.length; pi++) {
          p = p1[pi]
          px = p[0]
          py = p[1]
          for (i=0; i<4; i++) {
            dx = dxs[i]
            dy = dys[i]
            for (j=1; j<100; j++) {
              x = px + dx*j
              y = py + dy*j
              num = getTileNum(x, y)
              if (num != 0) {
                if (x == x2 && y == y2) return true;
                break;
              }
              p2.push([x, y])
            }
          }
        }

        return false;
      }

      function getTileNum(x, y) {
        if (x < 0 || 18 < x || y < 0 || 9 < y) return -1;
        return field[y][x];
      }

    </script>
  </body>
</html>
